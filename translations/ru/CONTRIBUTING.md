<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "bd4704f50c55da7d572b691484aa0b30",
  "translation_date": "2025-10-15T02:14:27+00:00",
  "source_file": "CONTRIBUTING.md",
  "language_code": "ru"
}
-->
# Вклад в Co-op Translator

Этот проект открыт для ваших вкладов и предложений. Для большинства вкладов потребуется согласиться с Contributor License Agreement (CLA), подтверждающим, что вы имеете право предоставлять нам права на использование вашего вклада. Подробнее: https://cla.opensource.microsoft.com.

Когда вы отправляете pull request, бот CLA автоматически определит, нужно ли вам подписать CLA, и отметит PR соответствующим образом (например, статус-проверка, комментарий). Просто следуйте инструкциям бота. Это потребуется сделать только один раз для всех репозиториев, использующих наш CLA.

## Настройка среды разработки

Для работы над проектом мы рекомендуем использовать Poetry для управления зависимостями. Мы используем `pyproject.toml` для управления зависимостями, поэтому для их установки используйте Poetry.

### Создание виртуального окружения

#### Через pip

```bash
python -m venv .venv
```

#### Через Poetry

```bash
poetry init
```

### Активация виртуального окружения

#### Для pip и Poetry

- Windows:

    ```bash
    .venv\Scripts\activate.bat
    ```

- Mac/Linux:

    ```bash
    source .venv/bin/activate
    ```

#### Через Poetry

```bash
poetry shell
```

### Установка пакета и необходимых зависимостей

#### Через Poetry (из pyproject.toml)

```bash
poetry install
```

### Ручное тестирование

Перед отправкой PR важно протестировать функцию перевода на реальной документации:

1. Создайте тестовую папку в корне проекта:
    ```bash
    mkdir test_docs
    ```

2. Скопируйте туда несколько markdown-документов и изображений, которые хотите перевести. Например:
    ```bash
    cp /path/to/your/docs/*.md test_docs/
    cp /path/to/your/images/*.png test_docs/
    ```

3. Установите пакет локально:
    ```bash
    pip install -e .
    ```

4. Запустите Co-op Translator на ваших тестовых документах:
    ```bash
    python -m co_op_translator --language-codes ko --root-dir test_docs
    ```

5. Проверьте переведённые файлы в `test_docs/translations` и `test_docs/translated_images`, чтобы убедиться:
   - В качестве перевода
   - В корректности метаданных в комментариях
   - В сохранении исходной структуры markdown
   - В работоспособности ссылок и изображений

Такое ручное тестирование помогает убедиться, что ваши изменения хорошо работают в реальных условиях.

### Переменные окружения

1. Создайте файл `.env` в корне проекта, скопировав шаблон `.env.template`.
1. Заполните переменные окружения согласно инструкции.

> [!TIP]
>
> ### Дополнительные варианты среды разработки
>
> Помимо локального запуска, вы можете использовать GitHub Codespaces или VS Code Dev Containers для альтернативной настройки среды разработки.
>
> #### GitHub Codespaces
>
> Вы можете запускать примеры виртуально через GitHub Codespaces без дополнительной настройки.
>
> Кнопка откроет веб-версию VS Code прямо в браузере:
>
> 1. Откройте шаблон (это может занять несколько минут):
>
>     <a href="https://codespaces.new/azure/co-op-translator"><img src="https://github.com/codespaces/badge.svg" alt="Открыть в GitHub Codespaces"></a>
>
> #### Локальный запуск через VS Code Dev Containers
>
> ⚠️ Этот вариант работает только если Docker Desktop выделено минимум 16 ГБ оперативной памяти. Если у вас меньше, попробуйте [GitHub Codespaces](../..) или [локальную настройку](../..).
>
> Похожий вариант — VS Code Dev Containers, который откроет проект в вашем локальном VS Code с помощью [расширения Dev Containers](https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-containers):
>
> 1. Запустите Docker Desktop (установите, если не установлен)
> 2. Откройте проект:
>
>    <a href="https://vscode.dev/redirect?url=vscode://ms-vscode-remote.remote-containers/cloneInVolume?url=https://github.com/azure/co-op-translator"><img src="https://img.shields.io/static/v1?style=for-the-badge&label=Dev%20Containers&message=Open&color=blue&logo=visualstudiocode" alt="Открыть в Dev Containers"></a>

### Стиль кода

Мы используем [Black](https://github.com/psf/black) как форматтер Python-кода для единообразия стиля во всём проекте. Black — это строгий форматтер, который автоматически приводит код к стандарту Black.

#### Конфигурация

Настройки Black указаны в нашем `pyproject.toml`:

```toml
[tool.black]
line-length = 88
target-version = ['py310']
include = '\.pyi?$'
```

#### Установка Black

Установить Black можно через Poetry (рекомендуется) или pip:

##### Через Poetry

Black устанавливается автоматически при настройке среды разработки:
```bash
poetry install
```

##### Через pip

Если используете pip, установите Black напрямую:
```bash
pip install black
```

#### Использование Black

##### С Poetry

1. Отформатировать все Python-файлы в проекте:
    ```bash
    poetry run black .
    ```

2. Отформатировать конкретный файл или папку:
    ```bash
    poetry run black path/to/file_or_directory
    ```

##### С pip

1. Отформатировать все Python-файлы в проекте:
    ```bash
    black .
    ```

2. Отформатировать конкретный файл или папку:
    ```bash
    black path/to/file_or_directory
    ```

> [!TIP]
> Рекомендуем настроить ваш редактор на автоматическое форматирование кода Black при сохранении. Большинство современных редакторов поддерживают это через расширения или плагины.

## Запуск Co-op Translator

Чтобы запустить Co-op Translator через Poetry в вашей среде, выполните следующие шаги:

1. Перейдите в папку, где хотите провести тесты перевода, или создайте временную папку для тестирования.

2. Выполните следующую команду. Замените `-l ko` на нужный вам языковой код. Флаг `-d` включает режим отладки.

    ```bash
    poetry run co-op-translator translate -l ko -d
    ```

> [!NOTE]
> Перед запуском убедитесь, что среда Poetry активирована (poetry shell).

## Добавление нового языка

Мы приветствуем вклад, расширяющий поддержку новых языков. Перед созданием PR выполните следующие шаги для ускорения проверки.

1. Добавьте язык в сопоставление шрифтов
   - Отредактируйте `src/co_op_translator/fonts/font_language_mappings.yml`
   - Добавьте запись с:
     - `code`: Языковой код в стиле ISO (например, `vi`)
     - `name`: Человеко-понятное название
     - `font`: Шрифт из `src/co_op_translator/fonts/`, поддерживающий нужный алфавит
     - `rtl`: `true` для письма справа налево, иначе `false`

2. Добавьте необходимые файлы шрифтов (если нужно)
   - Если требуется новый шрифт, проверьте лицензию на совместимость с open source
   - Добавьте файл шрифта в `src/co_op_translator/fonts/`

3. Локальная проверка
   - Запустите перевод на небольшом примере (Markdown, изображения, ноутбуки — по необходимости)
   - Проверьте корректность вывода, включая шрифты и RTL-верстку, если применимо

4. Обновите документацию
   - Убедитесь, что язык появился в `getting_started/supported-languages.md`
   - В `README_languages_template.md` ничего менять не нужно — он генерируется из списка поддерживаемых языков

5. Создайте PR
   - Опишите добавленный язык и вопросы по шрифту/лицензии
   - Приложите скриншоты результата, если возможно

Пример YAML-записи:

```yaml
new_lang(code):
  name: "New Language"
  font: "NotoSans-Medium.ttf"
  rtl: false
```


## Мейнтейнеры

### Формат коммитов и стратегия слияния

Для единообразия и понятности истории коммитов мы используем определённый формат **итогового коммита** при стратегии **Squash and Merge**.

Когда PR сливается, отдельные коммиты объединяются в один. Итоговое сообщение коммита должно соответствовать формату ниже для чистой и понятной истории.

#### Формат сообщения коммита (для squash and merge)

Используем такой формат:

```bash
<type>: <description> (#<PR number>)
```

- **type**: Категория коммита. Используем такие типы:
  - `Docs`: Обновления документации.
  - `Build`: Изменения, связанные со сборкой или зависимостями, включая конфигурационные файлы, CI, Dockerfile.
  - `Core`: Изменения основной функциональности или фич, особенно в `src/co_op_translator/core`.

- **description**: Краткое описание изменений.
- **PR number**: Номер pull request, связанного с коммитом.

**Примеры**:

- `Docs: Обновить инструкции по установке для ясности (#50)`
- `Core: Улучшить обработку перевода изображений (#60)`

> [!NOTE]
> В настоящее время префиксы **`Docs`**, **`Core`** и **`Build`** автоматически добавляются к заголовкам PR на основе меток, применённых к изменённому исходному коду. Если метка выбрана правильно, обычно не нужно вручную менять заголовок PR — просто проверьте, что всё корректно и префикс сгенерирован верно.

#### Стратегия слияния

Мы используем **Squash and Merge** как основную стратегию для pull request. Это гарантирует, что сообщения коммитов соответствуют нашему формату, даже если отдельные коммиты — нет.

**Причины**:

- Чистая, линейная история проекта.
- Единообразие сообщений коммитов.
- Меньше "шума" от мелких коммитов (например, "fix typo").

При слиянии убедитесь, что итоговое сообщение коммита соответствует описанному формату.

**Пример Squash and Merge**
Если в PR такие коммиты:

- `fix typo`
- `update README`
- `adjust formatting`

Они должны быть объединены в:
`Docs: Улучшить ясность и форматирование документации (#65)`

---

**Отказ от ответственности**:
Этот документ был переведен с помощью сервиса автоматического перевода [Co-op Translator](https://github.com/Azure/co-op-translator). Несмотря на стремление к точности, автоматические переводы могут содержать ошибки или неточности. Оригинальный документ на исходном языке следует считать авторитетным источником. Для получения критически важной информации рекомендуется профессиональный перевод человеком. Мы не несём ответственности за любые недоразумения или неправильные толкования, возникшие в результате использования данного перевода.